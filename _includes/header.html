<header class="site-header">

  <div class="above-nav-bg">
    <div class="wrapper above-nav">
      <div class="above-nav-main-content">
        <a href="/">
          <div class="opendds-logo">
            <img src="/images/opendds-horizontal.svg">
          </div>
        </a>
      </div>
    </div>
  </div>

  <div class="wrapper">
    <nav class="site-nav">
      <input type="checkbox" id="drop"/>
      <label for="drop" class="toggle"><span class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </span></label>
{% comment %}
      <!-- 
        The Following is useful for assessing the menu structure 
        un-comment it to get an overview of the current page ordering
      -->
      <!-- {% assign sorted_pages = site.pages | sort: "order"  %}
      {% for p in sorted_pages %}
      {% assign slash = p.url | split: '/' %}
      {% unless slash == empty
                  or p.redirect
                  or p.url == '/'
                  or p.url contains '.css'
                  or p.sitemap == false
                  or p.url == '/redirects.json' %}
        <div>--- {{p.order}} : {{p.url}} | {{p.redirect}}</div>
      {% endunless %}
      {% endfor %} -->
{% endcomment %}
      <ul class="trigger">
        {% assign sorted_pages = site.pages | where_exp:"item", "item.sitemap != false" | sort: "order" %}
        {% assign start_level = 2 %}
        {% assign level = start_level %}
        {% assign counter = 0 %}
        {% for p in sorted_pages %}
          {% assign slash = p.url | split: '/' %}
          {% unless slash == empty
                      or p.redirect
                      or p.url == '/'
                      or p.url contains '.css'
                      or p.url == '/redirects.json' %}
            {% assign indent = slash.size %}
            {% assign level_m1 = level | minus: 1 %}
            {% assign last = p.url | slice: -1, 1 %}
            {% for i in (indent..level_m1) %}</ul></li>{% endfor %}
            {% if last == '/' %}
                <li>
                  {% if p.hide_submenu != true %}
                  <input type="checkbox" id="drop-{{counter}}"/>
                  
                  <label for="drop-{{counter}}" class="toggle">
                    {% if p.menu_title %}
                      {{ p.menu_title }}
                    {% else %}      
                      {{ p.title }} 
                    {% endif %}                  
                    <span class="arrow">&#9660;</span>
                  </label>
                  {% endif %}

                  <a class="page-link" href="{{p.url | prepend: site.baseurl}}">
                    {% if p.menu_title %}
                      {{ p.menu_title }}
                    {% else %}      
                      {{ p.title }} 
                    {% endif %}

                    {% if p.hide_submenu != true %}
                      <span class="arrow">&#96{% if indent > 2 %}54{% else %}60{% endif %};</span>
                    {% endif %}
                  </a>

              {% assign counter = counter | plus: 1 %}
                  <ul class="sub-menu">
                {% if p.title == 'Documentation' %}
                    <li><a class="page-link" href="/documents/">All Documentation</a></li>
                    <li><a class="page-link" href="{{ site.data.opendds.latest_devguide_url }}">Developer's Guide [PDF]</a></li>
                {% else %}
                    <li class="mobile">
                      <a class="page-link" href="{{p.url | prepend: site.baseurl}}">                      
                        {% if p.menu_title %}
                        {{ p.menu_title }}
                      {% else %}      
                        {{ p.title }} 
                      {% endif %}
                      </a>
                    </li>
                {% endif %}
            {% else %}
                <li><a class="page-link" href="{{p.url | prepend: site.baseurl}}">
                  {% if p.menu_title %}
                    {{ p.menu_title }}
                  {% else %}      
                    {{ p.title }} 
                  {% endif %}
                </a></li>
            {% endif %}
            {% assign level = slash.size %}
          {% endunless %}
        {% endfor %}
        {% assign terminate_ul_count = level | minus: start_level %}
        {% for i in (0..terminate_ul_count) %}</ul>{% endfor %}
      </ul>
    </nav>
  </div>
</header>
